# Code generated by KubeVela templates. DO NOT EDIT.
apiVersion: core.oam.dev/v1alpha2
kind: TraitDefinition
metadata:
  annotations:
    definition.oam.dev/description: "add bookinfo-volume to pod"
  name: patch-volume
spec:
  appliesToWorkloads:
    - webservice
    - worker
    - microservice
  extension:
    template: |-
      patch: {
      	spec: template: spec: {
      		// +patchKey=name
      		containers: [{
      			name: parameter.containerName
      			// +patchKey=name
      			volumeMounts: [
      				for volumeMount in parameter.volumeMounts {
      					name:      volumeMount.name
      					mountPath: volumeMount.path
      				},
      			]
      		}]
      
      		// +patchKey=name
      		volumes: [
      			for volumeMount in parameter.volumeMounts {
      				name: volumeMount.name
      				if volumeMount.emptyDir != _|_ {
      					emptyDir: volumeMount.emptyDir
      				}
      			},
      		]
      	}
      }
      #EmptyDirConfig: {
      	medium?:    string
      	sizeLimit?: string
      }
      #VolumeMount: {
      	name:      string
      	path:      string
      	emptyDir?: #EmptyDirConfig
      }
      
      parameter: {
      	containerName: string
      	volumeMounts: [...#VolumeMount]
      }
      //parameter: {
      // volumeMounts: [{
      //  name: "readis"
      //  path: "/data"
      //  emptyDir: {}
      // }, {
      //  name: "test"
      //  path: "/data"
      //  emptyDir: {}
      // }, {
      //  name: "mysql"
      //  path: "/data"
      // }]
      //}
      //context: output: {
      // containername: "image"
      //}
      
