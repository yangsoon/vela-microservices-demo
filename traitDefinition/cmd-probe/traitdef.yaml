# Code generated by KubeVela templates. DO NOT EDIT.
apiVersion: core.oam.dev/v1alpha2
kind: TraitDefinition
metadata:
  annotations:
    definition.oam.dev/description: "A Probe detect the pod status by executing command"
  name: patch-probe
spec:
  appliesToWorkloads:
    - microservice
  extension:
    template: |-
      #ProbeConfig: {
      	periodSeconds: *10 | int
      	cmd: [...string]
      }
      parameter: {
      	readinessProbe: #ProbeConfig
      	livenessProbe:  #ProbeConfig
      }
      patch: {
      	spec: template: spec: {
      		// +patchKey=name
      		containers: [{
      			name: context.output.containerName
      			readinessProbe: {
      				periodSeconds: parameter.readinessProbe.periodSeconds
      				exec: command: parameter.readinessProbe.cmd
      			}
      			livenessProbe: {
      				periodSeconds: parameter.livenessProbe.periodSeconds
      				exec: command: parameter.livenessProbe.cmd
      			}
      		}]
      	}
      }
      parameter: {
      	readinessProbe: {cmd: ["ls"]}
      	livenessProbe: {cmd: ["ls"]}
      }
      //context: output: {
      // containerName: "image"
      //}
      
